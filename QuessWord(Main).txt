// QuessWord(Main).txt

MessageBarUp("Минутку !!!")
wait 500

DoModule CleaWord

Create Label { Name = Word, Action = SelectComment, TextColor = "Black", BackgroundColor = "White", X=0, Y = 0, Width = 110, Height = 20, FontName = "systemFont", FontSize=12, Alignment = "Left", CornerRadius = 0, ModelCell = modelCell[0] }
//
x = 0
y = 320
w = 115
h = 240
//
Create TableView { Name = ListWordTable, Action= SelectWord, X=x, Y=y, Width=w, Height=h, ModelCell=modelCell }
//
DelimiterNewLine = IntToChar(10)
DelimiterMemo = IntToChar(9989)
^Path = GetPathDirectoryDocument()
PathNameFile = ^Path + "QuessWord(AllWord).txt"
ContentFile = FileRead(PathNameFile)
ArrayWordImage = Components(ContentFile, DelimiterNewLine)
//
Struct TableComment { Word } 
//
CountRecords = CountElementsOfArray(ArrayWordImage)
for Index = 0 ; Index < CountRecords ;  Index ++
{
	WordImage = ArrayWordImage[Index]
	ArrayComponents = Components(WordImage, "*")
	Word = ArrayComponents[0]
	Word = Uppercased(Word)
	^ArrayWord[Index] = Word
	countComponents = CountElementsOfArray(ArrayComponents)
	^ArrayImage[Index] = ""
//print "countComponents =" + countComponents
	if countComponents > 1
	{
		TableComment.Word = DelimiterMemo + " " + Word
		Image = ArrayComponents[1]
		^ArrayImage[Index] = Image
	}
	else
	{
		TableComment.Word = "❌" + " " + Word
	}
	ListWordTable[Index] = TableComment
}
HideObject("Image")
HideObject("MiniImage")
HideObject("Save")
HideObject("Edit")
//HideObject("AddWord")
HideObject("BackLetter")
HideObject("SpaceBar")

ShowObject("ListWordTable")
^KeyboardView = "Show"
