// QuessWord(Main).txt

DoModule CleaWord

Create Label { Name = Word, Action = SelectComment, TextColor = "Black", BackgroundColor = "White", X=0, Y = 0, Width = 110, Height = 20, FontName = "systemFont", FontSize=12, Alignment = "Left", CornerRadius = 0, ModelCell = modelCell[0] }
//
x = 0
y = 320
w = 115
h = 240
//
Create TableView { Name = ListWordTable, Action= SelectWord, X=x, Y=y, Width=w, Height=h, ModelCell=modelCell }
//
DelimiterTab = IntToChar(9)
DelimiterNewLine = IntToChar(10)
DelimiterMemo = IntToChar(9989)
^Path = GetPathDirectoryDocument()
^NomerOK = "0"
NameFile = ^Path + "QuessWord(AllWord).txt"
ContentFile = FileRead(NameFile)
ArrayWordImage = Components(ContentFile, DelimiterNewLine)
//
Struct TableComment { Word } 
//
CountRecords = CountElementsOfArray(ArrayWordImage)
for Index = 0 ; Index < CountRecords ;  Index ++
{
	WordImage = ArrayWordImage[Index]
	ArrayComponents = Components(WordImage, DelimiterTab)
	Word = ArrayComponents[0]
	^ArrayWord[Index] = Word
	countComponents = CountElementsOfArray(ArrayComponents)
	^ArrayImage[Index] = ""
	If countComponents > 1
	{
		TableComment.Word = DelimiterMemo + " " + Word
		^ArrayImage[Index] = "üëç"
	}
	else
	{
		TableComment.Word = "‚ùå" + " " + Word
	}
	ListWordTable[Index] = TableComment
}
HideObject("Image")
ShowObject("ListWordTable")
