// QuessWord(LoadLevel).txt

MessageBarUp("Ждите !!!")
wait 100

DoModule CleaWord

DelimiterNewLine = IntToChar(10)
DelimiterMemo = IntToChar(9989)
^Path = GetPathDirectoryDocument()
nameFile = "QuessWord(AllWord" + ^Level + ").txt"
PathNameFile = ^Path + nameFile
//print "nameFile =" + nameFile
ContentFile = FileRead(PathNameFile)
ArrayWordImage = Components(ContentFile, DelimiterNewLine)
//
Struct TableComment { Word } 
//
CountRecords = CountElementsOfArray(ArrayWordImage)
for Index = 0 ; Index < CountRecords ;  Index ++
{
	WordImage = ArrayWordImage[Index]
	ArrayComponents = Components(WordImage, "*")
	Word = ArrayComponents[0]
	Word = Uppercased(Word)
	^ArrayWord[Index] = Word
	countComponents = CountElementsOfArray(ArrayComponents)
	^ArrayImage[Index] = ""
//print "Word(" + Index + ")=" + Word
	if countComponents > 1
	{
		TableComment.Word = DelimiterMemo + " " + Word
		Image = ArrayComponents[1]
		^ArrayImage[Index] = Image
	}
	else
	{
		TableComment.Word = "❌" + " " + Word
	}
	ListWordTable[Index] = TableComment
}

HideObject("Image")
HideObject("MiniImage")
HideObject("BackLetter")
HideObject("SpaceLetter")

ShowObject("ListWordTable")
^KeyboardView = "Show"
Level.text = "Уровень " + ^Level

MessageBarUp("")

